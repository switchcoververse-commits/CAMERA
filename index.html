<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>BRUTAL SCANNER - Precision Engineering</title>
    <style>
        body { margin: 0; background: #000; font-family: 'Inter', -apple-system, sans-serif; color: white; height: 100vh; display: flex; flex-direction: column; overflow: hidden; }
        
        /* Header Técnico */
        .header { height: 10%; background: #000; display: flex; align-items: center; justify-content: center; border-bottom: 2px solid #00d4ff; z-index: 100; }
        .header-text { font-size: 12px; font-weight: 800; letter-spacing: 2px; color: #00d4ff; text-transform: uppercase; }

        /* Visor de Escaneo */
        .viewport { position: relative; width: 100%; height: 70%; display: flex; align-items: center; justify-content: center; background: #050505; }
        video { position: absolute; width: 100%; height: 100%; object-fit: cover; }
        
        /* El Marco de Ingeniería (Ajustado para Multi-Gang) */
        scanner-frame {
    position: absolute; /* Cambiado para centrar mejor */
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 90%;      /* Más ancho para capturar más pared */
    height: 70%;     /* Más alto */
    border: 3px solid #ff0000; /* Rojo inicial, cambiará a verde con el nivel */
    border-radius: 10px;
    box-shadow: 0 0 0 5000px rgba(0, 0, 0, 0.75);
    z-index: 50;
    transition: all 0.3s ease; /* Para que el cambio de color sea suave */
}
        /* Cruces de precisión en las esquinas */
        .scanner-frame::before { content: ''; position: absolute; top: -10px; left: -10px; width: 20px; height: 20px; border-top: 4px solid #fff; border-left: 4px solid #fff; }
        .scanner-frame::after { content: ''; position: absolute; bottom: -10px; right: -10px; width: 20px; height: 20px; border-bottom: 4px solid #fff; border-right: 4px solid #fff; }

        /* Panel de Control Inferior */
        .footer { height: 20%; background: #000; display: flex; flex-direction: column; align-items: center; justify-content: center; border-top: 1px solid #222; z-index: 100; }
        
        .shutter-group { display: flex; align-items: center; justify-content: center; gap: 30px; width: 100%; }
        
        .shutter-btn { width: 80px; height: 80px; background: #fff; border-radius: 50%; border: 6px solid #00d4ff; cursor: pointer; transition: 0.2s; }
        .shutter-btn:active { transform: scale(0.85); background: #00d4ff; }
        
        .finish-btn { 
            background: #00d4ff; color: #000; border: none; padding: 16px 32px; 
            border-radius: 4px; font-weight: 900; font-size: 14px; display: none;
            text-transform: uppercase; cursor: pointer;
        }

        .status-bar { font-size: 10px; color: #555; margin-bottom: 10px; font-family: monospace; }
        .status-bar.active { color: #00d4ff; }
    </style>
</head>
<body>

    <div class="header">
        <div class="header-text">Universal Device Scanner v1.0</div>
    </div>

    <div class="viewport">
        <video id="video" autoplay playsinline></video>
        <div class="scanner-frame"></div>
    </div>

    <div class="footer">
        <div id="status" class="status-bar">READY TO SCAN...</div>
        <div class="shutter-group">
            <div id="capture" class="shutter-btn"></div>
            <button id="finish" class="finish-btn">Process Order</button>
        </div>
    </div>

    <canvas id="canvas" style="display:none;"></canvas>

    <script>
        const video = document.getElementById('video');
        const canvas = document.getElementById('canvas');
        const captureBtn = document.getElementById('capture');
        const finishBtn = document.getElementById('finish');
        const status = document.getElementById('status');
        
        let sessionPhotos = [];

       <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Universal Device Scanner V1.0</title>
    <style>
        body { margin: 0; padding: 0; background: #000; font-family: 'Courier New', monospace; overflow: hidden; color: #00d4ff; }
        
        .viewport { position: relative; width: 100vw; height: 80vh; background: #111; display: flex; justify-content: center; align-items: center; }
        video { width: 100%; height: 100%; object-fit: cover; }

        /* Marco de ingeniería ampliado */
        .scanner-frame {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            width: 85%;
            height: 65%;
            border: 3px solid #ff0000;
            border-radius: 10px;
            box-shadow: 0 0 0 5000px rgba(0, 0, 0, 0.7);
            z-index: 50;
            transition: border-color 0.3s ease;
            pointer-events: none;
        }

        .footer { height: 20vh; background: #000; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 10px; }
        .status-bar { font-size: 12px; margin-bottom: 15px; letter-spacing: 2px; text-transform: uppercase; }
        
        .shutter-group { display: flex; align-items: center; gap: 30px; }
        .shutter-btn { width: 70px; height: 70px; background: #fff; border-radius: 50%; border: 5px solid #00d4ff; cursor: pointer; }
        .shutter-btn:active { transform: scale(0.9); }
        
        .finish-btn { 
            display: none; 
            background: #00d4ff; color: #000; border: none; 
            padding: 12px 24px; font-weight: bold; border-radius: 5px; cursor: pointer; 
        }
    </style>
</head>
<body>

    <div class="viewport">
        <video id="video" autoplay playsinline></video>
        <div class="scanner-frame"></div>
    </div>

    <div class="footer">
        <div id="status" class="status-bar">ADJUST LEVEL TO SCAN</div>
        <div class="shutter-group">
            <div id="capture" class="shutter-btn"></div>
            <button id="finish" class="finish-btn">PROCESS ORDER</button>
        </div>
    </div>

    <canvas id="canvas" style="display:none;"></canvas>

    <script>
        const video = document.getElementById('video');
        const canvas = document.getElementById('canvas');
        const captureBtn = document.getElementById('capture');
        const finishBtn = document.getElementById('finish');
        const status = document.getElementById('status');
        const frame = document.querySelector('.scanner-frame');

        let sessionPhotos = [];

        // 1. Iniciar Cámara
        navigator.mediaDevices.getUserMedia({ video: { facingMode: "environment", width: 1280, height: 720 } })
            .then(stream => { video.srcObject = stream; })
            .catch(err => { status.innerText = "CAMERA ERROR"; });

        // 2. Nivel de Burbuja
        window.addEventListener('deviceorientation', (event) => {
            const beta = Math.abs(event.beta); 
            const gamma = Math.abs(event.gamma);
            if (beta > 75 && beta < 105 && Math.abs(gamma) < 5) {
                frame.style.borderColor = "#00ff00"; // VERDE
                status.innerText = "ALIGNED: READY";
            } else {
                frame.style.borderColor = "#ff0000"; // ROJO
                status.innerText = "ADJUST LEVEL";
            }
        });

        // 3. Captura de Fotos Múltiples
        captureBtn.addEventListener('click', () => {
            const context = canvas.getContext('2d');
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            context.drawImage(video, 0, 0, canvas.width, canvas.height);
            
            sessionPhotos.push(canvas.toDataURL('image/jpeg'));
            status.innerText = `CAPTURED: OUTLET ${sessionPhotos.length}`;
            finishBtn.style.display = "block";

            // Flash visual
            document.body.style.background = "#fff";
            setTimeout(() => { document.body.style.background = "#000"; }, 50);
        });

        // 4. Botón Finalizar
        finishBtn.addEventListener('click', () => {
            localStorage.setItem('scannedPhotos', JSON.stringify(sessionPhotos));
            window.location.href = "https://docs.google.com/forms/d/e/1FAIpQLScbU0wmhZIKDQAuYEoptN-RsS7f2FSGsTVoZqZTCIZu2oVCiA/viewform?usp=preview";
        });
    </script>
</body>
</html>
